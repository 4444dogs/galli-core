<html>
<div style="border: 1px solid black; width: 800px; height: 480px;">
    Frame
    <video id="player"></video>
</div>
<script>
    let resolveStartCapturePromise;
    const startCapturePromise = new Promise(a => resolveStartCapturePromise = a);

    async function startCapture(deviceId) {
        try {
            const stream = await window.navigator.mediaDevices.getUserMedia({
                video: {
                    mandatory: {
                        chromeMediaSource: 'tab',
                        chromeMediaSourceId: deviceId
                    }
                }
            });

            player.srcObject = stream;
            return true;
        } catch (err) {
            return false;
        }
    }

    window.addEventListener('message', async e => {
        const result = await startCapture(e.data.deviceId);
        resolveStartCapturePromise(result);
    });
</script>

</html>