<html>
<div style="border: 1px solid black; width: 800px; height: 480px;">
    Frame
    <video id="player"></video>
</div>
<script>
    let accept;
    window.startCapturePromise = new Promise(a => accept = a);

    async function startCapture(deviceId) {
        const stream = await window.navigator.mediaDevices.getUserMedia({
            video: {
                mandatory: {
                    chromeMediaSource: 'tab',
                    chromeMediaSourceId: deviceId
                }
            }
        });

        player.srcObject = stream;
        return true;
    }

    window.addEventListener('message', async e => {
        console.log(e.data);

        const result = await startCapture(e.data.deviceId);
        accept(result);
    });
</script>

</html>